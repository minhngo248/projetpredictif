<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Consulter rendez-vous</title>
        <meta charset="UTF-8">
        <!-- Librairie Javascript: jQuery (v3.4.1) -->
        <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    </head>
    <body>
        <div id="profil_client">
            <h2>Profil</h2>
            Nom: <span id="nom"></span><br/>
            <br/>
            Adresse : <span id="adresse"></span> <br/>
            <br/>
            né(e) le <span id="dob"></span>

            <h2>Profil astral</h2>
            Animal totem : <span id="totem"></span> <br/>
            <br/>
            Signe zodiaque : <span id="zodiaque"></span> <br/>
            <br/>
            Signe chinois : <span id="chinois"></span> <br/>
            <br/>
            Couleur : <span id="couleur"></span>
        </div>


        <div id="historique">
            <h2>Historique du client</h2>
            <table id="historique_client">
                <tr>
                    <th>Date</th>
                    <th>Médium (employé)</th>
                    <th>Commentaire</th>
                </tr>
            </table>
        </div>

        <div id="medium">
            <h2>Médium choisi par le client</h2>
            Nom : <span id="denom"></span><br/> 
            Type : <span id="role" ></span> <br/>
            <br/>
            <span id="presentation"></span> <br/>
            <br/>
        </div>

        <button id="bouton-pretRdv">Prêt pour le rendez-vous</button>

        <script type="text/javascript">
            function initPages() {
                $.ajax({
                    url: './ActionServlet',
                    method: 'POST',
                    data: {
                        todo: 'consulter-detail-rdv'
                    },
                    dataType: 'json'
                })
                .done(function (response) {
                    $('#nom').html(response.client.nom);
                    $('#dob').html(response.client.dob);
                    $('#adresse').html(response.client.adresse);

                    /*$('#totem').html(response.profil.totem);
                    $('#zodiaque').html(response.profil.zodiaque);
                    $('#chinois').html(response.profil.chinois);
                    $('#couleur').html(response.profil.couleur);*/
                    var listeRdv = response.client.historique;
                    $.each(listeRdv, function (i, rdv) {
                        $('#historique_client').append("<tr><td>" +
                            rdv.dateFin + "</td><td>" + rdv.medium + " " + rdv.employe + "</td><td> " + rdv.cmt + " </td></tr>");
                    });

                    $('#denom').html(response.medium.denom);
                    $('#role').html(response.medium.role);
                    $('#presentation').html(response.medium.presentation);
                   
                })
                        
                .fail(function (error) { // Fonction appelée en cas d'erreur lors de l'appel AJAX
                    console.log('Error', error); // LOG dans Console Javascript
                    alert("Erreur lors du chargement des donnees: HTTP Code " + error.status);
                });
            }

            $(document).ready(function () {
                initPages();
                $('#bouton-pretRdv').on('click', function () {
                });
            });
        </script>
    </body>
</html>

